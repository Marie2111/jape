%
%       Jape style
%       Bernard Sufrin, Oxford 1995 and 1996
%       $Id$
%
%
%
%       Provides
%
%       \begin{jape} ... \end{jape}               -- verbatim by another name
%       \begin{FIG}{label}{caption} ... \end{FIG} -- a figure, labelled #2-FIG
%       \figref{label}                            -- "Figure \ref{#1-FIG}"
%       \PJPFIG[sizecommand]{filestem}            -- printable Jape proof in line 
%       \PJPFIG[location]{filestem}{caption}      -- printable Jape proof as a figure 
%       \JPSPROOF [scaling] {filestem}            -- Jape postscript proof inline
%       \JPSFIG [scaling] {filestem} {caption}    -- Ditto as a figure
%
%       and
%
%       \Jape -- the Jape text logo
%       \JAPE -- the Jape graphic logo

\RequirePackage{verbatim}
\RequirePackage{konstanz}
\RequirePackage{xspace}
\RequirePackage{italicmath}
\RequirePackage{box-proof}
\RequirePackage{tree-proof}
\RequirePackage{epsfig}
\ProvidesPackage{jape}[1996/06/25 Bernard Sufrin's Jape Style]

\def\Jape{{\sc Jape}\xspace}
\def\JAPE{\fbox{$J\raisebox{-0.5ex}{$\forall$}P\raisebox{-0.5ex}{$\exists$}$}\xspace}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%       \begin{FIG}{label}{caption} ... \end{FIG}
%

\newcommand{\figscore}{\hbox to \textwidth{\leaders\hrule\hfil}}


\newenvironment{FIG}[3][hbtp]
{% [placing] {label} {caption}
\typeout{FIG [#1]}\begin{figure}[#1]\gdef\@fig@@capt{#3}\def\@fig@@label{#2}}
{\caption{\@fig@@capt}\label{\@fig@@label-FIG}\figscore\end{figure}}

\newcommand{\FIGREF}[1]{Figure \ref{#1-FIG}}
\newcommand{\figref}[1]{Figure \ref{#1}}

%
%       \PJPFIG[location]{filestem}{caption} -- printable Jape proof 
%       
\newcommand{\PJPFIG}[3][hbtp]{%
\begin{FIG}[#1]{#2}{#3\FIGURE@MARK{#2}}\begin{center}\input{#2.pjp.tex}\end{center}\end{FIG}}


% \PJPFIGBETWEEN [hbtb] {fileroot/label} {caption} {startline#} {stopline#}
% Should have a better way of allowing files to be used twice without
% duplicating the label than
% just doing symbolic linking in the filestore!
\newcommand{\PJPFIGBETWEEN}[5][hbtp]{%
\begin{FIG}[#1]{#2}{#3\FIGURE@MARK{#2}}\def\stop@Line{#5}\def\start@Line{#4}%
\begin{center}\input{#2.pjp.tex}\end{center}\end{FIG}}


\newcommand{\PJPPROOF}[2][\normalsize]{%
\let\Boxproofsize=#1
\let\Treeproofsize=#1
\vskip0.1ex\begin{center}\input{#2.pjp.tex}\end{center}\vskip0.1ex}

% These moved to the individual style files
%\def\JPSFONT{Konstanz.psf}
%\def\JPSFONT@SPECIAL{\special{header=\JPSFONT}\gdef\JPSFONT@SPECIAL{}}

\newcommand{\JPSPROOF}[2][]{% \JPSPROOF [scaling] {filestem}
\begin{center}\JPSFONT@SPECIAL\epsfig{file=#2.jps,#1}\end{center}}

\newcommand{\JPSFIG}[3][]{% \JPSFIG [scaling] {filestem} {caption} 
\begin{FIG}{#2}{#3\FIGURE@MARK{#2}}\JPSPROOF[#1]{#2}\end{FIG}}

\newcommand{\PLACEDJPSFIG}[4][]{% \JPSFIG [scaling] {filestem} {caption} 
\begin{FIG}[#4]{#2}{#3\FIGURE@MARK{#2}}\JPSPROOF[#1]{#2}\end{FIG}}

\newcommand{\SHOWFIGURE@MARK}[1]{\quad(#1)}
\newcommand{\HIDEFIGURE@MARK}[1]{}
\let\FIGURE@MARK=\HIDEFIGURE@MARK
\newcommand{\MARKFIGURES}{\let\FIGURE@MARK=\SHOWFIGURE@MARK}

\newcommand{\JPSTWINPROOFS}[3][]{% \JPSPROOF [scaling] {filestem}
\begin{center}\epsfig{file=#2.jps,#1}\quad\quad\quad\epsfig{file=#3.jps,#1}\end{center}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Jape environment -- begin and end macros
%                  -- just a renaming of verbatim
%                  -- characters 128-255 should be active for an extended coding
%
\def\jape{\relax\JPSFONT@SPECIAL\@verbatim \japesize\frenchspacing\@vobeyspaces\verbatim@start}
\let\endjape=\endtrivlist
\let\japesize=\normalsize
%
% jape* environment -- for those who really need to see spaces
%
\@namedef{jape*}{\JPSFONT@SPECIAL\@verbatim\verbatim@start}
\expandafter\let\csname endjape*\endcsname =\endtrivlist
%
%      \verb-style command for inline quotation of jape text
%
\def\jp{\relax
\ifmmode\hbox\else\leavevmode\null\fi
  \bgroup \let\do\do@noligs \verbatim@nolig@list
    \ttfamily \verb@eol@error \let\do\@makeother \dospecials
    \@ifstar{\@sverb}{\@vobeyspaces \jpsize\frenchspacing \@sverb}}
\let\verb@balance@group\@empty
\let\jpsize=\normalsize
%
%
%
 

























